<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Daily Entry</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#f2f4f7;margin:10px}
.container{max-width:1000px;margin:auto;background:#fff;padding:15px;border-radius:8px}
.row{display:flex;gap:10px;flex-wrap:wrap}
input{padding:8px;width:100%}
button{padding:10px;border:none;border-radius:6px;cursor:pointer}
#nextBtn{background:#1976d2;color:#fff}
#reportBtn{background:#444;color:#fff}
.table{width:100%;border-collapse:collapse;margin-top:10px}
.table th,.table td{border:1px solid #ccc;padding:6px}
.summary{display:flex;justify-content:space-between;font-weight:bold;margin-top:10px}
@media print{button,input{display:none}}
</style>
</head>
<body>
<div class="container">
<h2>Daily Entry</h2>

<div class="row">
<input type="date" id="date">
<input placeholder="Organisation" id="org">
<input placeholder="Name" id="name">
<input placeholder="Amount" id="amt" type="number">
</div><br>

<button id="nextBtn">NEXT</button>
<button id="reportBtn">REPORT VIEW</button>

<br><br>

<input id="search" placeholder="Search by Date, Name or Organisation">

<div id="todayBlock" style="display:none">
<div class="summary">
<div id="nos"></div>
<div id="total"></div>
</div>
<table class="table" id="todayTable"></table>
</div>

<table class="table" id="searchTable"></table>

</div>

<script>
const key="dailyEntries";
const dateI=document.getElementById("date");
dateI.value=new Date().toISOString().slice(0,10);

function getData(){ return JSON.parse(localStorage.getItem(key)||"[]"); }
function saveData(d){ localStorage.setItem(key,JSON.stringify(d)); }

document.getElementById("nextBtn").onclick=()=>{
 const org=orgI.value.trim();
 const name=nameI.value.trim();
 const amt=amtI.value.trim();
 if(!org||!name||!amt){alert("Fill all");return;}
 const d=getData();
 d.push({id:Date.now(),date:dateI.value,org,name,amt:+amt});
 saveData(d);
 orgI.value=nameI.value=amtI.value="";
 document.getElementById("search").value="";
 render();
}

document.getElementById("reportBtn").onclick=()=>location.href="report.html";

const orgI=document.getElementById("org");
const nameI=document.getElementById("name");
const amtI=document.getElementById("amt");

function render(){
 const q=document.getElementById("search").value.toLowerCase();
 const data=getData();
 document.getElementById("searchTable").innerHTML="";
 document.getElementById("todayBlock").style.display="none";

 if(q===""){
  return; // blank when no search
 }

 const f=data.filter(d=>d.date.includes(q)||d.name.toLowerCase().includes(q)||d.org.toLowerCase().includes(q));

 if(!f.length) return;

 let t=0;
 let h="<tr><th>Date</th><th>Org</th><th>Name</th><th>Amount</th></tr>";
 f.forEach(r=>{t+=r.amt; h+=`<tr><td>${r.date}</td><td>${r.org}</td><td>${r.name}</td><td>${r.amt}</td></tr>`;});
 h+=`<tr><th colspan="3">Total</th><th>${t}</th></tr>`;
 document.getElementById("searchTable").innerHTML=h;
}

document.getElementById("search").oninput=render;
</script>
</body>
</html>
