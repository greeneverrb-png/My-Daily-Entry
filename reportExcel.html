<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Excel Report</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#f2f4f7;margin:10px}
.container{max-width:1100px;margin:auto;background:#fff;padding:15px;border-radius:8px}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:6px}
th{background:#f0f0f0}
.topbar{display:flex;gap:10px;margin-bottom:10px}
button{padding:6px 10px;border:none;border-radius:6px;cursor:pointer;background:#1976d2;color:#fff}
@media print{button{display:none}}
</style>
</head>
<body>

<div class="container">
<h2>Excel View Report</h2>

<div class="topbar">
<button onclick="window.print()">Print</button>
<button onclick="history.back()">Back</button>
</div>

<table id="excelTable"></table>
</div>

<script>
const data = JSON.parse(localStorage.getItem("excelData") || "[]");
const table = document.getElementById("excelTable");

let h="<tr><th>Date</th><th>Organisation</th><th>Name</th><th>Amount</th></tr>";
let total=0;

data.forEach(d=>{
 total+=d.amt;
 h+=`<tr>
  <td>${d.date}</td>
  <td>${d.org}</td>
  <td>${d.name}</td>
  <td>${d.amt}</td>
 </tr>`;
});

h+=`<tr><th colspan="3">Total</th><th>${total}</th></tr>`;
table.innerHTML=h;
</script>

</body>
</html>
